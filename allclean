#!/bin/bash
HERE=`pwd`
CLOONIX_COMMON=${HERE}/cloonix/common
CLOONIX_SERVER=${HERE}/cloonix/server
CLOONIX_CLIENT=${HERE}/cloonix/client
CLOONIX_CONFIG=${HERE}/cloonix/cloonix_config
if [ ! -e $CLOONIX_CONFIG ]; then
  echo NOT FOUND:
  echo $CLOONIX_CONFIG
  exit
fi
CLOONIX_VERSION=$(cat ./cloonix/cloonix_config | grep CLOONIX_VERSION)
CLOONIX_VERSION=${CLOONIX_VERSION#*=}
rm -f cloonix-${CLOONIX_VERSION}.tar.gz
rm -rf tmpbuild
rm -rf tmpbuild_bis
#----------------------------------------------------------
  for i in meson_ninja \
           agent_dropbear \
           xwy \
           lib_rpc_clownix \
           lib_rpc_qmonitor \
           lib_rpc_doors \
           lib_rpc_layout ; do

    cd ${CLOONIX_COMMON}/${i}
    ./allclean
  done
#----------------------------------------------------------
  for i in  doorways \
            suid_power \
            uml_cloonix_switch ; do
    cd ${CLOONIX_SERVER}/${i}
    make clean
  done 
  rm -f ${CLOONIX_SERVER}/dtach/dtach

  for i in dpdk ovs qemu nat_dpdk d2d_dpdk \
           a2b_dpdk xyx_dpdk ovs_drv ; do
    cd ${CLOONIX_SERVER}/${i}
    ./allclean
  done
#----------------------------------------------------------
  for i in  lib_client \
            ctrl \
            xwycli \
            qmonitor \
            cairo_canvas/crcanvas_gtk \
            cairo_canvas/src/bank \
            cairo_canvas/src/interface \
            cairo_canvas/src/subsets \
            cairo_canvas/src/bdplot \
            cairo_canvas ; do
    cd ${CLOONIX_CLIENT}/${i}
    make clean
  done
  for i in  openssh spice ; do 
    cd ${CLOONIX_CLIENT}/${i}
    ./allclean
  done
#----------------------------------------------------------
